<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet">
    <meta name="description" content="vim快捷键 复制光标所在行 yy复制光标所在行到系统的剪贴板 &quot;+yy粘贴系统剪贴板的内容  &quot;+p全部复制：按esc后，按键ggyG粘贴 p删除/剪切  dd删除当前行到文件结尾的内容 dG/apache  在文档中查找apache 按n跳到下一个，shift+n上一个光标移动到文件的第一行  gg光标移动到文件的最后一行  G光标移动到这一行的行首  0（数字0）把光标移动大这一行的结尾 $">
<meta name="keywords" content="ios,物联网,人工智能,网络安全">
<meta property="og:type" content="website">
<meta property="og:title" content="2019.8.21-星期三">
<meta property="og:url" content="http://yoursite.com/backup/2019-8-21-星期三.html">
<meta property="og:site_name" content="八道真君">
<meta property="og:description" content="vim快捷键 复制光标所在行 yy复制光标所在行到系统的剪贴板 &quot;+yy粘贴系统剪贴板的内容  &quot;+p全部复制：按esc后，按键ggyG粘贴 p删除/剪切  dd删除当前行到文件结尾的内容 dG/apache  在文档中查找apache 按n跳到下一个，shift+n上一个光标移动到文件的第一行  gg光标移动到文件的最后一行  G光标移动到这一行的行首  0（数字0）把光标移动大这一行的结尾 $">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821150456.png">
<meta property="og:image" content="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821145950.png">
<meta property="og:image" content="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821173310.png">
<meta property="og:image" content="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821174533.png">
<meta property="og:updated_time" content="2019-10-13T00:42:24.887Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2019.8.21-星期三">
<meta name="twitter:description" content="vim快捷键 复制光标所在行 yy复制光标所在行到系统的剪贴板 &quot;+yy粘贴系统剪贴板的内容  &quot;+p全部复制：按esc后，按键ggyG粘贴 p删除/剪切  dd删除当前行到文件结尾的内容 dG/apache  在文档中查找apache 按n跳到下一个，shift+n上一个光标移动到文件的第一行  gg光标移动到文件的最后一行  G光标移动到这一行的行首  0（数字0）把光标移动大这一行的结尾 $">
<meta name="twitter:image" content="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821150456.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>2019.8.21-星期三</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
    <div class="content index py4">
        
          <header id="header">
  <a href="/">
  
    
      <div id="logo" style="background-image: url(/images/logo.png);filter:none;"></div>
    
  
    <div id="title">
      <h1>八道真君</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fas fa-bars fa-2x"></i></a>
      </li>
       
        <li><a href="/">Home</a></li>
       
        <li><a href="/about/">About</a></li>
       
        <li><a href="/archives/">Writing</a></li>
       
        <li><a href="/categories/">Categories</a></li>
       
        <li><a href="/tags/">Tags</a></li>
      
    </ul>
  </div>
</header>

        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  

  <div class="content" itemprop="articleBody">
      
          <p>vim快捷键</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">复制光标所在行 yy</span><br><span class="line">复制光标所在行到系统的剪贴板 <span class="string">"+yy</span></span><br><span class="line"><span class="string">粘贴系统剪贴板的内容  "</span>+p</span><br><span class="line">全部复制：按esc后，按键ggyG</span><br><span class="line">粘贴 p</span><br><span class="line">删除/剪切  dd</span><br><span class="line">删除当前行到文件结尾的内容 dG</span><br><span class="line">/apache  在文档中查找apache 按n跳到下一个，<span class="built_in">shift</span>+n上一个</span><br><span class="line"></span><br><span class="line">光标移动到文件的第一行  gg</span><br><span class="line">光标移动到文件的最后一行  G</span><br><span class="line">光标移动到这一行的行首  0（数字0）</span><br><span class="line">把光标移动大这一行的结尾 $</span><br><span class="line"></span><br><span class="line">在命令行模式下输入 u 可以撤销上一次的操作</span><br><span class="line">r   与u相反，表示重做前一步操作</span><br><span class="line">.   点，表示重复前一个操作，例：想多次复制，一直按这个点就行了</span><br></pre></td></tr></table></figure>
<p>vim 是否支持系统剪贴板</p>
<p>用vim 打开一个文件，然后执行命令：reg 查看是否有 + 或者 × 号  或者执行：version 命令 查看是否有+clipboard<br>
1.如果存在：则可以使用 “+y 将vim 里面的内容复制到系统剪贴板或者 +p 将系统剪贴板里面的内容复制到vim 里面<br>
2.如果不存在：则需要安装vim-gnome， 然后就可以用以上命令粘贴复制</p>
<p>ps: 也可以在 /etc/vim/.vimrc 里面设置 clipboard=unnamedplus 这样就可以直接使用 y p命令直接粘贴复制了</p>
<h4 id="shell学习"><a class="markdownIt-Anchor" href="#shell学习"></a> shell学习</h4>
<p>shell中的变量默认是当作字符串类型<br>
data+&quot;%F&quot;    # 2019-8-21<br>
命令替换<br>
aa=``<br>
aa=$()<br>
执行命令的结果,赋值给变量</p>
<p>read -n 2 -p “describe” ip   #读入一个变量，有提示，长度为2<br>
read ip1 ip2 ip3<br>
1.1.1.1 2.2.2.2 3.3.3.3<br>
默认按空格拆分成三个变量</p>
<p>#!/usr/bin/bash</p>
<p>变量引用中的问题</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">name=liuyuxiao</span><br><span class="line"><span class="string">"<span class="variable">$name</span> is good"</span>   <span class="comment">#liuyuxiao i good</span></span><br><span class="line"><span class="string">'$name is good'</span>   <span class="comment">#$name is good</span></span><br></pre></td></tr></table></figure>
<p>单引号不会解析变量</p>
<p>当遇见感叹号 双引号会有问题<br>
“name is good !”<br>
“name is good”’!’</p>
<p>运算<br>
方法一：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">expr expr 1 + 2</span><br><span class="line">expr <span class="variable">$num1</span> + <span class="variable">$num2</span> + - \* / %</span><br><span class="line">这里的*要转义</span><br><span class="line">要</span><br></pre></td></tr></table></figure>
<p>方法二：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$(()) <span class="built_in">echo</span> $((<span class="variable">$num1</span>+<span class="variable">$num2</span>)) + - * / %</span><br><span class="line"><span class="built_in">echo</span> $((num1+num2))</span><br><span class="line"><span class="built_in">echo</span> $((5-3*2))</span><br><span class="line"><span class="built_in">echo</span> $(((5-3)*2))</span><br><span class="line"><span class="built_in">echo</span> $((2**3))</span><br><span class="line">sum=$((1+2));</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$sum</span></span><br></pre></td></tr></table></figure>
<p>方法三：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$[] <span class="built_in">echo</span> $[5+2] + - * / %</span><br><span class="line"><span class="built_in">echo</span> $[5**2]</span><br><span class="line">``` </span><br><span class="line">方法四：</span><br><span class="line">```bash</span><br><span class="line"><span class="built_in">let</span> sum=2+3;<span class="built_in">echo</span> <span class="variable">$sum</span> </span><br><span class="line"><span class="built_in">let</span> i++;<span class="built_in">echo</span> <span class="variable">$i</span></span><br></pre></td></tr></table></figure>
<p><code>bash -vx *.sh</code>  以调试的方式执行<br>
<code>sh -vx 02.sh</code> 以调试的方式执行，查询整个执行过程</p>
<p>小数运算</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"2*4"</span> |bc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"2^4"</span> |bc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"scale=2;6/4"</span> |bc</span><br><span class="line">awk <span class="string">'BEGIN&#123;print 1/2&#125;'</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"print 5.0/2"</span> |python</span><br></pre></td></tr></table></figure>
<p>变量的删除和替换</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#url&#125;</span> 获取变量值的长度</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url#*.&#125;</span> 从前往后，最短匹配  这里的.就是.,删除到第一个点</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url##*.&#125;</span> 从前往后，最长匹配 贪婪匹配，删除到最后一个点</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%.*&#125;</span> 从后往前删，删除到第一个点，最短匹配</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%%.*&#125;</span> 从后往前删，删除到最后一个点最长匹配 贪婪匹配</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url:0:5&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url:5&#125;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url/n/N&#125;</span>  替换其中的第一个n为N</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url//n/N&#125;</span> 贪婪匹配，替换所有的n为N</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;var1-aaaaa&#125;</span> 给变量设置默认值，如果var1不存在，则这个表达式的值为aaaaa，空值不会被替代</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;var1:-aaaaa&#125;</span> 与上面的区别是，如果是空值也会被替代</span><br></pre></td></tr></table></figure>
<p>预定义变量</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$0</span> 脚本名 </span><br><span class="line">$* 所有的参数 </span><br><span class="line"><span class="variable">$@</span> 所有的参数 </span><br><span class="line"><span class="variable">$#</span> 参数的个数 </span><br><span class="line">$$ 当前进程的 PID  </span><br><span class="line">$! 上一个后台进程的 PID </span><br><span class="line">$? 上一个命令的返回值 0 表示成功   </span><br><span class="line">``` </span><br><span class="line">\$*和\<span class="variable">$@</span>的区别 </span><br><span class="line">``` </span><br><span class="line">可以看到不加引号时,二者都是返回传入的参数, 但加了引号后,此时 $*把参数作为一个字符串整体(单字符串)返回, <span class="variable">$@</span>把每个参数作为一个字符串返回 </span><br><span class="line">```  </span><br><span class="line">[[~=]] 按正则方式匹配  </span><br><span class="line"><span class="comment">#### 条件测试 </span></span><br><span class="line">```bash </span><br><span class="line"><span class="built_in">test</span> -d /path      是否是一个目录 <span class="built_in">test</span>     </span><br><span class="line">        -a     &amp;&amp;     </span><br><span class="line">        -o     ||     </span><br><span class="line">        -n     字符串长度不为0     </span><br><span class="line">        -z     字符串长度为0     </span><br><span class="line">        str = str2     </span><br><span class="line">        str != str2 </span><br><span class="line">        ! <span class="built_in">test</span> -d /path    取反 [ -d /path ]      [是命令  ]是[命令的参数 </span><br><span class="line">``` </span><br><span class="line">文件测试</span><br></pre></td></tr></table></figure>
<p>见周二笔记</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">数值比较 </span><br><span class="line">``` bash</span><br><span class="line">[ 1 -gt 10 ] 大于</span><br><span class="line">[ 1 -lt 10 ] 小于</span><br><span class="line">[ 1 -eq 10 ] 等于</span><br><span class="line">[ 1 -ne 10 ] 不等于</span><br><span class="line">[ 1 -ge 10 ] 大于等于</span><br><span class="line">[ 1 -le 10 ] 小于等于  </span><br><span class="line">``` </span><br><span class="line">字符串比较         </span><br><span class="line">特殊符号 </span><br><span class="line">``` bash</span><br><span class="line">() 子 shell 中执行  </span><br><span class="line">(()) 数值比较，运算 C 语言  </span><br><span class="line">$() 命令替换  </span><br><span class="line">$(()) 整数运算 </span><br><span class="line">&#123;&#125;  </span><br><span class="line">$&#123;&#125;  </span><br><span class="line">[] 条件测试  </span><br><span class="line">[[]] 条件测试，支持正则 =~  </span><br><span class="line">$[] 整数运算  </span><br><span class="line">```   </span><br><span class="line">`grep &apos;cat $1&apos; *`  </span><br><span class="line"></span><br><span class="line">从当前所有文件中查找内容包含cat $1的脚本  读取文件对每一行进行处理 </span><br><span class="line"></span><br><span class="line">``` bash</span><br><span class="line">for ip in `cat $1` </span><br><span class="line">do </span><br><span class="line">done </span><br><span class="line">``` </span><br><span class="line">超过90发邮件 </span><br><span class="line"></span><br><span class="line">``` bash</span><br><span class="line">if [ $disk_use -ge 90];then</span><br><span class="line">    echo &quot;`aasdasdasd`&quot; | mail -s &quot;disk war&quot; $mail_user </span><br><span class="line">```  </span><br><span class="line">``` bash</span><br><span class="line">[ 1 -lt 2 -a 5 -gt 10 ];echo $? 1 </span><br><span class="line">[ 1 -lt 2 -o 5 -gt 10 ];echo $? 0  </span><br><span class="line">[[ 1 -lt 2 &amp;&amp; 5 -gt 10 ]];echo $?  1 </span><br><span class="line">[[ 1 -lt 2 || 5 -gt 10 ]];echo $?    </span><br><span class="line">使用正则 </span><br><span class="line"> [[ &quot;$num20&quot; =~ ^[0-9]+$ ]];echo $?  </span><br><span class="line">判断是否是数字 </span><br><span class="line">[[ ! &quot;$num&quot; =~ ^[0-9]+$ ]] </span><br><span class="line">``` </span><br><span class="line">#### 流程控制 </span><br><span class="line">单分支结构 </span><br><span class="line">``` bash</span><br><span class="line">if 条件测试  </span><br><span class="line">    then 命令序列  </span><br><span class="line">fi  </span><br><span class="line">``` </span><br><span class="line">双分支结构 </span><br><span class="line">``` bash</span><br><span class="line">if 条件测试  </span><br><span class="line">    then 命令序列  </span><br><span class="line">    else 命令序列  </span><br><span class="line">fi  </span><br><span class="line">``` </span><br><span class="line">多分支结构  </span><br><span class="line">``` bash</span><br><span class="line">if 条件测试 1  </span><br><span class="line">    then 命令序列    </span><br><span class="line">    [elif 条件测试 2  </span><br><span class="line">    then 命令序列    </span><br><span class="line">    elif 条件测试 3   </span><br><span class="line">    then 命令序列] </span><br><span class="line">    ...    </span><br><span class="line">    else 命令序列 </span><br><span class="line">fi  </span><br><span class="line">```   </span><br><span class="line">#### case的用法 </span><br><span class="line">``` bash</span><br><span class="line">case $name in  </span><br><span class="line">1)     命令序列     </span><br><span class="line">        ;; </span><br><span class="line">2)     命令序列     </span><br><span class="line">        ;; </span><br><span class="line">*)     无匹配命令序列 </span><br><span class="line">esac </span><br><span class="line">``` </span><br><span class="line">通过cat来实现多行输出 </span><br><span class="line">```bash</span><br><span class="line">cat&lt;&lt;-EOF </span><br><span class="line">    +-------------------+</span><br><span class="line">    |                   | </span><br><span class="line">    |                   | </span><br><span class="line">    +-------------------+ </span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<h4 id="ifs"><a class="markdownIt-Anchor" href="#ifs"></a> IFS</h4>
<p>IFS 是一种 set 变量，当 shell 处理&quot;命令替换&quot;和&quot;参数替换&quot;时，shell 根据 IFS 的值，默认是 space, tab, newline 来拆解读入的变量，然后对特殊字符进行处理，最后重新组合赋值给该变量。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line">OLD_IFS=<span class="variable">$IFS</span> <span class="comment">#保存原始值 </span></span><br><span class="line">IFS=<span class="string">""</span>   <span class="comment">#改变IFS的值  IFS=$'\n' 使用换行作为分隔符 ... ...</span></span><br><span class="line">IFS=<span class="variable">$OLD_IFS</span> <span class="comment">#还原IFS的原始值 </span></span><br><span class="line">``` </span><br><span class="line"><span class="comment">#### 循环 </span></span><br><span class="line">ping -W 超时时间  <span class="keyword">for</span>循环 </span><br><span class="line">``` bash</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..254&#125;;<span class="keyword">do</span>   <span class="comment">#`seq 2 254` </span></span><br><span class="line">    ping xxx </span><br><span class="line"><span class="keyword">done</span>  </span><br><span class="line"><span class="keyword">for</span> alpha <span class="keyword">in</span> a b c d;<span class="keyword">do</span>     </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$alpha</span> </span><br><span class="line"><span class="keyword">done</span>  </span><br><span class="line">list=<span class="string">"a b c d"</span> </span><br><span class="line"><span class="keyword">for</span> alpha <span class="keyword">in</span> <span class="variable">$list</span>;<span class="keyword">do</span>     </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$alpha</span> </span><br><span class="line"><span class="keyword">done</span>  </span><br><span class="line">list=<span class="string">"a b c d"</span> </span><br><span class="line"><span class="keyword">for</span> alpha <span class="keyword">in</span> <span class="string">"<span class="variable">$list</span>"</span>;<span class="keyword">do</span>  </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$list</span> </span><br><span class="line"><span class="keyword">done</span> 这时输出就只有一行a b c d。 </span><br><span class="line">``` </span><br><span class="line">可以把循环体用&#123;&#125;括起来，然后加&amp;放到后台执行 </span><br><span class="line">``` bash</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..254&#125;;<span class="keyword">do</span>   <span class="comment">#`seq 2 254`    </span></span><br><span class="line">&#123;         </span><br><span class="line">    ping xxx     </span><br><span class="line">&#125;&amp; </span><br><span class="line"><span class="keyword">done</span> </span><br><span class="line">``` </span><br><span class="line">加依赖 </span><br><span class="line">``` bash</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..254&#125;;<span class="keyword">do</span>   <span class="comment">#`seq 2 254`     </span></span><br><span class="line">&#123;         </span><br><span class="line">    ping xxx     </span><br><span class="line">&#125;&amp; </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span> <span class="comment">#等待所有的后台进程结束 </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"finish"</span> </span><br><span class="line">```  </span><br><span class="line">任何脚本前面可以加一个time来统计执行时间 </span><br><span class="line">`time ./ping101.sh`  </span><br><span class="line">whie循环 通过重定向读文件 </span><br><span class="line">``` bash</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> user <span class="keyword">do</span>   </span><br><span class="line">    useradd <span class="variable">$user</span> </span><br><span class="line"><span class="keyword">done</span> &lt; user.txt </span><br><span class="line">```  </span><br><span class="line"><span class="keyword">while</span> 会读空行，<span class="keyword">for</span>不会读空行  </span><br><span class="line">until循环 </span><br><span class="line">``` bash</span><br><span class="line">until <span class="built_in">command</span>;<span class="keyword">do</span> </span><br><span class="line">commnds <span class="keyword">done</span> </span><br><span class="line">和<span class="keyword">while</span>一样，唯一不同的是如果<span class="built_in">command</span>返回0，则不执行，否则就执行 </span><br><span class="line">```  </span><br><span class="line">文件句柄 </span><br><span class="line">``` bash</span><br><span class="line">touch /file1</span><br><span class="line"><span class="built_in">exec</span> 6&lt;&gt; /file1 //打开文件             打开文件句柄</span><br><span class="line">ll /proc/2$/fd                         列出打开的文件句柄</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tianyun"</span> &gt; /proc/2$/fd/6        通过句柄写入文件 </span><br><span class="line"><span class="built_in">exec</span> 6&lt;&amp;-                            释放文件句柄 </span><br><span class="line">``` </span><br><span class="line">管道也是文件 </span><br><span class="line">匿名管道 </span><br><span class="line">``` xxx | yyy</span><br></pre></td></tr></table></figure>
<p>命名管道</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkfifo /tmp/fifo1 </span><br><span class="line">```  </span><br><span class="line">使用管道 </span><br><span class="line">``` bash</span><br><span class="line"><span class="comment">#终端a </span></span><br><span class="line">grep aaa /tmp/fifo1  <span class="comment">#如果管道中没东西会卡住 </span></span><br><span class="line"><span class="comment">#终端b </span></span><br><span class="line">ll /dev &gt; /tmpfifo1 </span><br><span class="line">``` </span><br><span class="line">控制并发的数量 </span><br><span class="line">``` bash</span><br><span class="line"><span class="meta">#!/usr/bin/bash </span></span><br><span class="line">thread = 5 </span><br><span class="line">tmp_fifofile = /tmp/2$/fifo</span><br><span class="line">mkfifo <span class="variable">$tmp_fifofile</span></span><br><span class="line"><span class="built_in">exec</span> 8 &lt;&gt; <span class="variable">$tmp_fifofile</span></span><br><span class="line">rm <span class="variable">$tmp</span> &gt; fifofile</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq <span class="variable">$thread</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> &gt;&amp;8</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..254&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">read</span> -u 8    <span class="comment">#-u 后面接的是文件描述符</span></span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">        <span class="built_in">echo</span> &gt;&amp;8</span><br><span class="line">    &#125;&amp;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>删除ssh指纹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /root/.ssh/known_hosts  <span class="comment">#删除掉对应的行</span></span><br></pre></td></tr></table></figure>
<p>except的用法<br>
包括bash中嵌入except用法<br>
-EOF中不能有一个空格，必须全部tab键来进行缩进<br>
如果expect没有装 就装<br>
<img src="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821150456.png" alt></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ssh-keygen -P &quot;&quot; -f ~/.ssh/id_rsa</span><br></pre></td></tr></table></figure>
<p><img src="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821145950.png" alt></p>
<p>还可以在spawn上面 加上 set timeout 10 设置一下超时时间</p>
<p>expect 中的位置变量</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> ip [lindex <span class="variable">$argv</span> 0]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/expect </span></span><br><span class="line"><span class="built_in">set</span> ip [lindex <span class="variable">$argv</span> 0] </span><br><span class="line"><span class="built_in">set</span> user root </span><br><span class="line"><span class="built_in">set</span> password centos </span><br><span class="line"><span class="built_in">set</span> timeout 5 </span><br><span class="line"> </span><br><span class="line">spawn ssh <span class="variable">$user</span>@<span class="variable">$ip</span> </span><br><span class="line"> </span><br><span class="line">expect &#123;  </span><br><span class="line"><span class="string">"yes/no"</span> &#123; send <span class="string">"yes\r"</span>; exp_continue &#125;  </span><br><span class="line"><span class="string">"password:"</span> &#123; send <span class="string">"<span class="variable">$password</span>\r"</span> &#125;; </span><br><span class="line">&#125;  </span><br><span class="line"><span class="comment">#interact expect "#" </span></span><br><span class="line">send <span class="string">"useradd yangyang\r"</span> </span><br><span class="line">send <span class="string">"pwd\r"</span> send <span class="string">"exit\r"</span> </span><br><span class="line">expect eof</span><br></pre></td></tr></table></figure>
<h4 id="数组"><a class="markdownIt-Anchor" href="#数组"></a> 数组</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">array2=(tom jack alice) </span><br><span class="line">array3=(`cat /etc/passwd`) 希望是将该文件中的每一个行作为一个元数赋 值给数组 array3 </span><br><span class="line">array4=(`ls /var/ftp/Shell/<span class="keyword">for</span>*`) </span><br><span class="line">array5=(tom jack alice <span class="string">"bash shell"</span>) </span><br><span class="line">colors=(<span class="variable">$red</span> <span class="variable">$blue</span> <span class="variable">$green</span> <span class="variable">$recolor</span>) </span><br><span class="line">array5=(1 2 3 4 5 6 7 <span class="string">"linux shell"</span> [20]=puppet)</span><br><span class="line">关联数组 <span class="comment">#declare -A ass_array1='([index4]="peach" [index1]="pear" [index2]="apple" [index3]="orange" )</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;ass_array2[index2]&#125;</span> 访问数组中的第二个元数 </span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;ass_array2[@]&#125;</span> 访问数组中所有元数 等同于 <span class="built_in">echo</span> <span class="variable">$&#123;array1[*]&#125;</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#ass_array2[@]&#125;</span> 获得数组元数的个数</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;!ass_array2[@]&#125;</span> 获得数组元数的索引</span><br><span class="line"><span class="comment"># 使用切片取值</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;array1[@]:1:2&#125;</span></span><br></pre></td></tr></table></figure>
<p>数组的遍历</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;!array[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$i</span>: <span class="variable">$&#123;array[i]&#125;</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>函数<br>
函数的返回值默认是最后一条指令的返回值<br>
如果手动返回，则返回值不能超过255<br>
如果想返回其他的结果可以通过设置外部变量的方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#这叫函数的输出</span><br><span class="line">func()&#123;</span><br><span class="line">    echo $[2*$1]</span><br><span class="line">&#125;</span><br><span class="line">result=`func 123`</span><br></pre></td></tr></table></figure>
<p>传数组怎么处理<br>
<img src="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821173310.png" alt></p>
<p>输出一个数组<br>
<img src="https://adddd-1251699369.cos.ap-shanghai.myqcloud.com/20190821174533.png" alt></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exit 退出整个程序</span><br><span class="line">shift 使位置变量左移，$2变成$1,$3变成$2,$#也会减1</span><br><span class="line">shift 1</span><br><span class="line">shift 2</span><br></pre></td></tr></table></figure>
<p>vim</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">不含元字符的替换</span><br><span class="line">:%s/tom/Tom/g    <span class="comment">#%s相当于全文相当于1,$，g表示全局</span></span><br><span class="line">含元字符的替换</span><br><span class="line">:%s/\&lt;[tT]om\TOM&gt;/g    词首\&lt; 词尾\&gt; </span><br><span class="line">:%s/\(10.18.40.\)100/\1200/g    \1代表前面第一个括号内的内容</span><br><span class="line">:1,$ s\\\</span><br></pre></td></tr></table></figure>
<p>grep</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-q  表示不输出</span><br><span class="line">grep 返回值</span><br><span class="line">    0 找到了</span><br><span class="line">    1 没找到</span><br><span class="line">    2 文件不存在</span><br><span class="line">-i  忽略大小写</span><br><span class="line">-v  去反</span><br><span class="line">-r  -R  递归</span><br><span class="line">-o  只显示匹配的</span><br><span class="line">-A1  打印匹配的后面的1行</span><br><span class="line">-B1  打印匹配的前面的1行</span><br><span class="line">-C1  打印匹配上下的1行</span><br><span class="line">-l   列出匹配的文件名</span><br><span class="line">-n   列出所在文件的行数</span><br><span class="line"></span><br><span class="line">vim xxx.txt +n   <span class="comment">#直接定位到行</span></span><br><span class="line">找目录</span><br><span class="line">ll || grep <span class="string">'^d'</span></span><br></pre></td></tr></table></figure>
<p>egrep 可以把扩展字符不带斜线  &lt;&gt;除外</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed 只有模式命令出现语法错误的时候才会是非0 否则都是0</span><br><span class="line"></span><br><span class="line">sed ! 对所选行以外的所有行应用命令 </span><br><span class="line"></span><br><span class="line">sed -r <span class="string">''</span> pasword</span><br><span class="line">sed -r -n <span class="string">''</span> password   <span class="comment">#默认会打印，-n取消默认的打印</span></span><br><span class="line">sed -rn <span class="string">'/^root/p'</span> password  </span><br><span class="line">-n p 一般不用特别关注，因为默认都是交给后面的命令打印的</span><br><span class="line"></span><br><span class="line">sed -r <span class="string">'s/root/alice/g'</span></span><br><span class="line">sed -r <span class="string">'s/root/&amp;alice/g'</span>   <span class="comment">#&amp;代表前面匹配到的内容</span></span><br><span class="line">将/换成<span class="comment">#</span></span><br><span class="line">sed -r <span class="string">'\#root#d'</span>           这种情况下需要转义</span><br><span class="line">sed -r <span class="string">'s#root#alice#'</span>        这种情况下不需要转义</span><br><span class="line"></span><br><span class="line">sed地址</span><br><span class="line">可以是数字、正则表达式或者是二者的结合</span><br><span class="line">sed -r <span class="string">'d'</span></span><br><span class="line">sed -r <span class="string">'3d'</span></span><br><span class="line">sed -r <span class="string">'1,3d'</span></span><br><span class="line">sed -r <span class="string">'1,$d'</span></span><br><span class="line">sed -r <span class="string">'/root/,5d'</span>   <span class="comment">#在第二个斜线后面可以结合上面的</span></span><br><span class="line">从每次匹配到root开始删除到第5行</span><br><span class="line">sed -r <span class="string">'/root/,+5d'</span></span><br><span class="line">从每次匹配到root开始删除5行</span><br><span class="line"></span><br><span class="line">sed多个命令</span><br><span class="line">sed -r <span class="string">'3d'</span> </span><br><span class="line">sed -r <span class="string">'3&#123;h;d&#125;'</span>  或者 <span class="string">'3h;3d'</span>   <span class="comment">#同一行多个命令</span></span><br><span class="line"></span><br><span class="line">sed -r <span class="string">'2r /etc/password'</span>   <span class="comment">#在第二行的时候读入</span></span><br><span class="line">sed -r <span class="string">'/root/w /etc/password'</span> <span class="comment">#将root匹配到的行写入到文件</span></span><br><span class="line">sed -r <span class="string">'/root/a11111111'</span>   <span class="comment">#将匹配的root行追加1111111</span></span><br><span class="line">sed -r <span class="string">'/root/i11111111'</span>   <span class="comment">#将匹配的root行前面插入1111111</span></span><br><span class="line">sed -r <span class="string">'/root/c11111111'</span>   <span class="comment">#将匹配的root行整行替换成1111111</span></span><br><span class="line">vim</span><br><span class="line">:r /ect/password</span><br><span class="line">将这个文件读入到光标位置</span><br><span class="line"></span><br><span class="line">a 在当前行后添加一行或多行 </span><br><span class="line">c 用新文本修改（替换）当前行中的文本 </span><br><span class="line">d 删除行 i 在当前行之前插入文本 </span><br><span class="line">l 列出非打印字符 </span><br><span class="line">p 打印行 </span><br><span class="line">n 读入下一输入行，并从下一条命令而不是第一条命令开始对其的处理 </span><br><span class="line">q 结束或退出 </span><br><span class="line"></span><br><span class="line">h 从模式空间取出，覆盖到暂存空间</span><br><span class="line">H 从模式空间取出，追加到暂存空间</span><br><span class="line">g 从暂存空间取回，覆盖到模式空间</span><br><span class="line">G 从暂存空间取回，追加到模式空间</span><br></pre></td></tr></table></figure>
<p>暂存空间默认会有一个换行</p>
<p>awk 是一种编程语言<br>
awk [options] commands filenames</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">默认按空格和tab分隔</span><br><span class="line"></span><br><span class="line">-F 指定分隔符</span><br><span class="line"></span><br><span class="line">命令出现三段</span><br><span class="line">awk <span class="string">'BEGIN&#123;&#125;&#123;&#125;END&#123;&#125;'</span></span><br><span class="line">BEGIN:发生在读文件之前</span><br><span class="line">END:发生读文件之后</span><br><span class="line"></span><br><span class="line">awk <span class="string">'BEGIN&#123;FS=":";OFS="----"&#125;&#123;print $1,$2&#125;'</span> passwd <span class="comment">#FS是输入的分隔符 OFS是输出的分隔符</span></span><br><span class="line">awk <span class="string">'pattern&#123;action&#125;'</span></span><br><span class="line">awk <span class="string">'$4&gt;25000&#123;print $4&#125;'</span></span><br><span class="line"></span><br><span class="line">整行是<span class="variable">$0</span>,然后每列对应的$列</span><br><span class="line">NR   总记录的number</span><br><span class="line">FNR  当前记录文件的number</span><br><span class="line">NF   这行一共多少个字段</span><br><span class="line"><span class="variable">$NF</span>  最后一个字段</span><br><span class="line"></span><br><span class="line">FS                    默认按空格和tab分隔</span><br><span class="line">OFS                     默认是空格</span><br><span class="line">RS                   输入记录分隔符</span><br><span class="line">ORS                    输出记录分隔符</span><br></pre></td></tr></table></figure>
<p>awk 条件输出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">awk -F: <span class="string">'&#123;if($3==0)&#123;i++&#125; else if($3&gt;999)&#123;k++&#125; else&#123;j++&#125;&#125; END&#123;print i; print k; print j&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<p>awk 循环</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">awk -F: <span class="string">'&#123;i=1; while(i&lt;=NF)&#123;print $i; i++&#125;&#125;'</span> /etc/hosts</span><br></pre></td></tr></table></figure>
<p>awk 数组</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">awk -F: <span class="string">'&#123;username[++i]=$1&#125; END&#123;print username[1]&#125;'</span> /etc/passwd</span><br></pre></td></tr></table></figure>
<p>awk 数组按索引遍历</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># awk -F: '&#123;username[++x]=$1&#125; END&#123;for(i in username) &#123;print i,username[i]&#125; &#125;' /etc/passwd</span></span><br></pre></td></tr></table></figure>
<p>awk 数组字符串</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ss -an |grep :80 |awk <span class="string">'&#123;access_stat[$2]++&#125; END&#123;for(i in access_stat)&#123;print i,access_stat[i]&#125;&#125;'</span></span><br></pre></td></tr></table></figure>
<p>awk 自定义变量</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">awk -v my_name=<span class="string">"ghostwu"</span> <span class="string">'BEGIN&#123;print my_name&#125;'</span></span><br><span class="line">awk <span class="string">'BEGIN&#123; my_name="ghost"; my_age=22; my_sex="男"; print my_name, my_age, my_sex&#125;'</span></span><br></pre></td></tr></table></figure>
        
  </div>
</article>

        
        <footer id="footer">
  
  <script
    async
    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
  ></script>

  <span id="busuanzi_container_site_pv"
    >总访问量<span id="busuanzi_value_site_pv"></span>次</span
  >
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_uv"
    >总访客<span id="busuanzi_value_site_uv"></span>人</span
  >
  <span class="post-meta-divider">|</span>
  

  <div class="footer-left">
    Copyright &copy; 2019 八道真君
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
        <li>
          <a href="/"
            >Home</a
          >
        </li>
        
        <li>
          <a href="/about/"
            >About</a
          >
        </li>
        
        <li>
          <a href="/archives/"
            >Writing</a
          >
        </li>
        
        <li>
          <a href="/categories/"
            >Categories</a
          >
        </li>
        
        <li>
          <a href="/tags/"
            >Tags</a
          >
        </li>
        
      </ul>
    </nav>
  </div>

  <style>
    body {
      max-width: 60rem !important;
      font-size: 1rem !important;
      font-weight: 500 !important;
    }
    h2{
      color:#2bbc8a !important;
    }
    h3{
      font-size: 1rem !important;
      color: #e0d1ac !important;
      text-decoration: none !important;
    }
    code{
      margin-left: 2px;
      margin-right: 2px;
      font-size: 15px;
      font-weight: 1000;
      padding: 2px;
      border: 1px dotted #666;
      color:  #2bbc8a
    }
    body td{
      padding: 0px 8px 0
    }
    .katex {
      font: 400 1em KaTeX_Main,Times New Roman,serif;
    }
    .px3 {
      padding-right: 3rem;
      padding-left: 3rem;
    }

    .highlight {
      background: black !important;
    }
    pre {
      font-size: 0.9rem !important;
    }
    html {
      border-top: 0px !important;
    }
    #header #nav {
      font-size: 1rem;
    }
    .abtn {
      background: rgba(255, 255, 255, 0);
      color: white;
      text-align: left;
      border: 0;
      outline: none;
      text-decoration: none;
      font-size: 13px;
      left: 2px;
      display: inline-block;
    }
    .abtn:hover {
      text-decoration: underline;
      cursor: pointer;
    }
    .no-is-collapsed {
      max-height: 1000px;
    }
    .js-toc-expanded {
      max-height: 800px;
      overflow-y: scroll;
    }
    .js-toc-expanded::-webkit-scrollbar {
      display: none;
    }
  </style>
  <script src="https://cdn.bootcss.com/jquery/3.4.0/jquery.min.js"></script>

  <script>
    var isExpanded = false;
    var isShow = true;
    $(document).ready(function() {
      if (/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)) {
        $("body")[0].style.paddingLeft = "2rem";
        $("body")[0].style.paddingRight = "2rem";
       
        //移动端
        $("body")[0].style.maxWidth = "48rem!important";
        if ($(".js-toc").length == 0) {
          $("#bottom-placeholder")[0].style.height = "0px";
        }else{
          $("#bottom-placeholder")[0].style.height = "64px";
        }
      } else {
        $("body")[0].style.maxWidth = "60%!important";
        $("#bottom-placeholder")[0].style.height = "0px";
      }
      // if (document.documentElement.clientWidth <= 1250) {
      //   document.getElementsByClassName("js-toc")[0].style.display = "none";
      // } else {
      //   var style = document.getElementsByClassName("js-toc")[0].style;
      //   style.display = "inline";
      //   if(document.documentElement.clientWidth>1400){
      //       style.left = "5%"
      //   }else{
      //       style.left = "1%"
      //   }
      // }
   
      if ($(".js-toc").length > 0) {
        ajustToc(); //此函数在post.ejs
        $(".js-toc").prepend(
          "<div ><div style='display: inline-block;'><button class='abtn' id='show' onclick='toggleTocShow()'>显示目录</button><button class='abtn' id='expand' onclick='toggleToc()'>展开</button></div><div style='display: inline-block;'><font style='font-size:13px;color:#2bbc8a'  id='tip'>1%<font></div></div>"
        );
        showScrollTip();
        toggleTocShow();
        $(window).bind("scroll", function() {
          showScrollTip();
          // var liTop = $(".is-active-li").position().top;    
          // var contentH = $(".js-toc").height();
          // var clientH = 800;
          // var scrolltop =0;
          // if(liTop>800&&liTop<850){
          //   scrolltop = 400;
          // }else if(liTop>1200&&liTop<1250){
          //   scrolltop = 800;
          // }else if(liTop>1600&&liTop<1650){
          //   scrolltop = 1200;
          // }



          
          // if((liTop+800)>contentH){
          //   scrolltop = contentH-800;
          // }
          // $(".js-toc").animate({scrollTop:scrolltop},300);   
          // console.log($(".is-active-li").position().top);          
        });
        
      }
    });
    function showScrollTip(){
      var top = $(this).scrollTop(); // 当前窗口的滚动距离
          var contentY = $("article .content").offset().top;
          var contentH = $("article .content").height();
          var cw = $(window).height();
          // console.log("cw:"+cw+",top:"+top+",contentY:"+contentY+",contentH:"+contentH);
          var tip = parseInt((cw+top-contentY)/contentH*100);
          if(tip>100) tip=100;
          $("#tip").text(tip+"%");
    }
    function toggleToc() {
      if (isExpanded) {
        $(".no-is-collapsed").each(function(e) {
          $(this).removeClass("no-is-collapsed");
        });
        $("#expand").text("展开");
        isExpanded = false;
        $(".js-toc").each(function(e) {
          $(this).removeClass("js-toc-expanded");
        });
      } else {
        $(".is-collapsed").each(function(e) {
          $(this).addClass("no-is-collapsed");
        });
        $("#expand").text("自动");
        $(".js-toc").each(function(e) {
          $(this).addClass("js-toc-expanded");
        });
        isExpanded = true;
      }
    }
    function toggleTocShow(){
       if(isShow){
          $(".toc-list:first").hide();
          $("#show").text("显示目录");
          $("#expand").hide();
       }else{
         $("#expand").show();
         $(".toc-list:first").show();
         $("#show").text("隐藏目录");
       }
       isShow =! isShow;
    }
  </script>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?acdcaa5a48f961d9125ca706ddde18e1";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


    <div id="bottom-placeholder" style="height:0px;"></div>
</body>
</html>
